http://www.cs.ucsb.edu/~tyang/class/240b99/homework/sam_mm.c
